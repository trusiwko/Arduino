# Проект Затухание

Зажигаем светодиод плавно.

На ардуино рядом с некоторыми пинами есть знак ~ (тильда), который указывает на то, что пин поддерживает ШИМ, а конкретно указывает на то, что на данный пин можно подавать любое значение от 0 (мин) до 255 (макс).

Для подачи напряжения в 5 В необходимо передать значение 255, для подачи напряжения в 2.5 В необходимо передать значение 128, и т.д. Значение передается с помощью функции:
```C++
analogWrite(PIN, 100);
```

## Задача

Для того, чтобы плавно зажечь светодиод, можно через каждые 30 мс передавать нарастающее значение, например: 5, 10, 15, 20, 25, 30, 35 ... 255, для этого можно написать код:
```C++
analogWrite(PIN, 0);
delay(30);
analogWrite(PIN, 5);
delay(30);
analogWrite(PIN, 10);
delay(30);
analogWrite(PIN, 15);
delay(30);
analogWrite(PIN, 20);
delay(30);
analogWrite(PIN, 25);
delay(30);
//... и так далее еще 50 раз
analogWrite(PIN, 255);
delay(30);
```

## Вариант 1. Цикл while

Данный подход очень неудобен, для того, чтобы сократить код будем использовать цикл. Цикл - это выполнение определенного куска кода до тех пор, пока не будет выполнено какое-нибудь условие.
Для цикла нужна переменная - это место, где будет храниться текущее значение 0, 5, 10 и т.д. Назовем переменную i. Получим такой код:

```C++
#define PIN 9

int i; // Переменная

void setup() {
   pinMode(PIN, OUTPUT);
}

void loop() {
  i = 0; // В начале цикла присвоим значение 0
  while (i <= 255) { // Пока переменная меньше 256 будет постоянно выполняться данный блок (ниже в блоке переменная будет расти, блок закончится, когда переменная станет больше 255)
    // Установим значение на пине:
    analogWrite(PIN, i);
    delay(30);
    // Увеличим переменную на 5, т.е. была 0, станет 5, была 5, станет 10
    i += 5;
  }
}
```

## Вариант 2. Цикл for
Цикл for является облегченной версией while. В данном цикле в одном месте собраны первоначальное присваивание i = 0, условие i <= 255 и увеличение переменной i += 5:

```C++
#define PIN 9

int i;

void setup() {
   pinMode(PIN, OUTPUT);
}

void loop() {
  for (i = 0; i <= 255; i+=5) {
    analogWrite(PIN, i);
    delay(30);
  }
}
```

## Вариант 3. Без циклов.
Цикл плох тем, что пока он выполняется другая логика не выполняется. В нашем случае цикл выполняется чуть больше 40 раз. Каждый такой раз мы ждем 30 мс, т.е. в целом цикл выполняется 1.2 секунды. Наша программа "зависает" на это время и не выполняет то, что расположено до и после цикла. Поэтому лучше данную логику разместить в основном цикле программы:

```C++
#define PIN 9

int i = 0; // Ставим начальное значение переменной = 0

void setup() {
   pinMode(PIN, OUTPUT);
}

void loop() {
    // Выдаем на пине указанное значение:
    analogWrite(PIN, i);
    delay(30);
    // Увеличиваем текущее значение на 5, чтобы в следующей итерации цикла его вывести
    i += 5;
    // Но т.к. оно все время увеличивается, нужно сбросить его на ноль тогда, когда оно достигнет потолка:
    if (i > 255) {
      i = 0;
    }
}
```

![Demo](https://github.com/trusiwko/Arduino/raw/master/eKids/Lesson4/fade_demo.gif)
